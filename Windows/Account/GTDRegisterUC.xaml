<UserControl x:Class="KirillPolyanskiy.CustomBrokerWpf.WindowsAccount.GTDRegisterUC"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
			xmlns:lib="clr-namespace:KirillPolyanskiy.DataModelClassLibrary;assembly=DataModelClassLibrary"
			xmlns:libui="clr-namespace:KirillPolyanskiy.WpfControlLibrary;assembly=WpfControlLibrary"
			 xmlns:local="clr-namespace:KirillPolyanskiy.CustomBrokerWpf"
             mc:Ignorable="d" 
             d:DesignHeight="150" d:DesignWidth="3500" DataContextChanged="UserControl_DataContextChanged">
    <Grid>
        <Grid.Resources>
            <lib:BindingProxy x:Key="DataContext" Data="{Binding}"/>
        </Grid.Resources>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <ToolBar Height="32">
            <Button ToolTip="Экспорт в Excel" Command="{Binding Path=ExcelExport}" CommandParameter="{Binding ElementName=MainDataGrid, Path=.}" IsTabStop="False">
                <Image Source="/CustomBrokerWpf;component/Images/excel_export.png" />
            </Button>
            <Button ToolTip="Копировать" Command="Copy" IsTabStop="False">
                <Image Source="/CustomBrokerWpf;component/Images/copy.png" />
            </Button>
            <Separator/>
            <Button Command="{Binding Path=FilterClear}" ToolTip="Очистить фильтры" IsTabStop="False">
                <Image Source="/CustomBrokerWpf;component/Images/funnel_delete.png" />
            </Button>
            <Separator/>
            <Button Command="{Binding Path=SaveRefresh}" ToolTip="Обновить информацию">
                <Image Source="/CustomBrokerWpf;component/Images/r2Refresh-512.png" />
            </Button>
            <Button ToolTip="Сохранить изменения в БД" Command="{Binding Path=Save}" IsTabStop="False" Visibility="{Binding Source={StaticResource keyVisibilityAccounts}, Path=Visibility, Mode=OneWay}">
                <Image Source="/CustomBrokerWpf;component/Images/save.png" />
            </Button>
            <Button Command="{Binding Path=Reject}" ToolTip="Отменить несохраненные изменения" Visibility="{Binding Source={StaticResource keyVisibilityAccounts}, Path=Visibility, Mode=OneWay}" >
                <Image Source="/CustomBrokerWpf;component/Images/rRemove-512.png" />
            </Button>
            <Popup IsOpen="{Binding Path=PopupIsOpen}" StaysOpen="False" Placement="Center" PopupAnimation="Fade" AllowsTransparency="True" Visibility="Collapsed" IsHitTestVisible="False" Grid.ColumnSpan="2" >
                <Border BorderBrush="Beige" BorderThickness="2" Background="{Binding Path=PopupBackground}" CornerRadius="7">
                    <TextBlock Text="{Binding Path=PopupText}" Margin="2"  FontStyle="Italic" Foreground="Teal" />
                </Border>
            </Popup>
        </ToolBar>
        <ScrollViewer x:Name="MainScrollViewer" Grid.Row="1" VerticalScrollBarVisibility="Disabled" ScrollChanged="ScrollViewer_ScrollChanged">
            <ScrollViewer.Style>
                <Style TargetType="ScrollViewer">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding ElementName=MainDataGrid, Path=HasItems, Mode=OneWay}" Value="False">
                            <Setter Property="HorizontalScrollBarVisibility" Value="Visible"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </ScrollViewer.Style>
            <DataGrid x:Name="MainDataGrid" Grid.Row="1" ItemsSource="{Binding Items}" IsReadOnly="{Binding Source={StaticResource keyVisibilityAccounts}, Path=IsOutsider,Mode=OneWay}" ColumnWidth="90" CanUserAddRows="False" CanUserDeleteRows="False" AlternatingRowBackground="{x:Null}" AlternationCount="0" RowBackground="#FFC1DEDE" SelectionUnit="CellOrRowHeader" AreRowDetailsFrozen="False"
							  ColumnDisplayIndexChanged="DataGrid_ColumnDisplayIndexChanged" ScrollViewer.ScrollChanged="Scrol_ScrollChanged" LoadingRowDetails="DataGrid_LoadingRowDetails">
                <DataGrid.Resources>
                    <libui:CheckListBoxPopup x:Key="AgentFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.AgentFilter}" MinWidth="50" MaxHeight="{x:Static local:References.WorkAreaHight}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:NumberFilterPopup x:Key="DTRateFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.DTRateFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:CheckListBoxPopup x:Key="ClientFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.ClientFilter}" MinWidth="50" MaxHeight="{x:Static local:References.WorkAreaHight}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:NumberFilterPopup x:Key="CostLogisticsFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.CostLogisticsFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:NumberFilterPopup x:Key="CostPerFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.CostPerFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:NumberFilterPopup x:Key="CostTotalFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.CostTotalFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:NumberFilterPopup x:Key="DDSpidyFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.DDSpidyFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:CheckListBoxPopup x:Key="DeclarationNumberFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.DeclarationNumberFilter}" MinWidth="50" MaxHeight="{x:Static local:References.WorkAreaHight}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:NumberFilterPopup x:Key="DTSumRubFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.DTSumRubFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:NumberFilterPopup x:Key="FeeFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.FeeFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:NumberFilterPopup x:Key="GTLSFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.GTLSFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:NumberFilterPopup x:Key="GTLSCurFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.GTLSCurFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:DateFilterPopup x:Key="GTLSDateFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.GTLSDateFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:NumberFilterPopup x:Key="GTLSRateFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.GTLSRateFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:NumberFilterPopup x:Key="MarkupAlgFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.MarkupAlgFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:NumberFilterPopup x:Key="MarkupBUFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.MarkupBUFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:NumberFilterPopup x:Key="MarkupTotalFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.MarkupTotalFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:NumberFilterPopup x:Key="MFKFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.MFKFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:NumberFilterPopup x:Key="MFKRateFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.MFKRateFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:NumberFilterPopup x:Key="MFKWithoutRateFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.MFKWithoutRateFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:CheckListBoxPopup x:Key="ParcelFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.ParcelFilter}" MinWidth="50" MaxHeight="{x:Static local:References.WorkAreaHight}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:NumberFilterPopup x:Key="PariFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.PariFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:NumberFilterPopup x:Key="ProfitFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.ProfitFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:NumberFilterPopup x:Key="ProfitabilityFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.ProfitabilityFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:NumberFilterPopup x:Key="ProfitAlgEFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.ProfitAlgEFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:NumberFilterPopup x:Key="ProfitAlgRFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.ProfitAlgRFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:NumberFilterPopup x:Key="ProfitDiffFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.ProfitDiffFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:CheckListBoxPopup x:Key="RateFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.RateFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:NumberFilterPopup x:Key="SellingFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.SellingFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:DateFilterPopup x:Key="SellingDateFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.SellingDateFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:NumberFilterPopup x:Key="SellingRateFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.SellingRateFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:NumberFilterPopup x:Key="SellingWithoutRateFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.SellingWithoutRateFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:NumberFilterPopup x:Key="SLFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.SLFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:NumberFilterPopup x:Key="SLRateFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.SLRateFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:NumberFilterPopup x:Key="SLWithoutRateFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.SLWithoutRateFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:NumberFilterPopup x:Key="TaxFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.TaxFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:NumberFilterPopup x:Key="TotalSumFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.TotalSumFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:NumberFilterPopup x:Key="VATFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.VATFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:NumberFilterPopup x:Key="VATPayFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.VATPayFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:NumberFilterPopup x:Key="VolumeFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.VolumeFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:NumberFilterPopup x:Key="VolumeProfitFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.VolumeProfitFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:NumberFilterPopup x:Key="WestGateFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.WestGateFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:NumberFilterPopup x:Key="WestGateRateFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.WestGateRateFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                    <libui:NumberFilterPopup x:Key="WestGateWithoutRateFilterPopup" DataContext="{Binding Source={StaticResource DataContext}, Path=Data.WestGateWithoutRateFilter}" Placement="Right" VerticalOffset="0" HorizontalOffset="4" PopupAnimation="Fade"/>
                </DataGrid.Resources>
                <DataGrid.RowDetailsTemplate>
                    <DataTemplate>
                        <DataGrid ItemsSource="{Binding Clients}" IsReadOnly="{Binding RelativeSource={RelativeSource AncestorType=DataGrid, Mode=FindAncestor}, Path=IsReadOnly}" CanUserAddRows="False" CanUserDeleteRows="False" HeadersVisibility="Row" SelectionUnit="CellOrRowHeader" BorderThickness="0" RowBackground="#e0f7e3" SelectedIndex="-1"  HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Disabled" CanUserResizeColumns="False" CanUserReorderColumns="False" CanUserSortColumns="False">
                            <DataGrid.Columns>
                                <DataGridTextColumn SortMemberPath="Specification.Parcel.ParcelNumberOrder" IsReadOnly="True"/>
                                <DataGridTextColumn SortMemberPath="Specification.Declaration.Number" IsReadOnly="True"/>
                                <DataGridTextColumn SortMemberPath="Specification.Agent.Name" IsReadOnly="True"/>
                                <DataGridTextColumn Binding="{Binding SellingDate, Mode=OneWay, StringFormat=\{0:d\}}" ElementStyle="{StaticResource StyleTextBlockAlignmentCenter}"/>
                                <DataGridTextColumn Binding="{Binding Path=Selling, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}"/>
                                <DataGridTextColumn Binding="{Binding Path=SellingWithoutRate, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}"/>
                                <DataGridTextColumn Binding="{Binding Path=SellingRate, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}"/>
                                <DataGridTextColumn Binding="{Binding Path=Client.Name, TargetNullValue='', Mode=OneWay}">
                                    <DataGridTextColumn.CellStyle>
                                        <Style TargetType="DataGridCell">
                                            <Setter Property="ToolTip" Value="{Binding RelativeSource={RelativeSource Self}, Path=Content.Text}"/>
                                            <Setter Property="FontWeight" Value="{Binding Client.NameFontWeight}"/>
                                        </Style>
                                    </DataGridTextColumn.CellStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Binding="{Binding Path=Rate, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRight}"/>
                                <DataGridTextColumn Binding="{Binding Path=Fee, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}"/>
                                <DataGridTextColumn Binding="{Binding Path=Tax, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}"/>
                                <DataGridTextColumn Binding="{Binding Path=VAT, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}"/>
                                <DataGridTextColumn Binding="{Binding Path=DTSum, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}"/>
                                <DataGridTextColumn Binding="{Binding Path=BuyRate, StringFormat=\{0:N4\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRight}"/>
                                <DataGridTextColumn SortMemberPath="DTSumRub" IsReadOnly="True"/>
                                <DataGridTextColumn Binding="{Binding Path=CC, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}"/>
                                <DataGridTextColumn Binding="{Binding Path=Pari, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}"/>
                                <DataGridTextColumn Binding="{Binding Path=SL, StringFormat=\{0:N2\}, TargetNullValue='', Mode=TwoWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}" EditingElementStyle="{StaticResource StyleTextBoxAlignmentRightTotal}"/>
                                <DataGridTextColumn Binding="{Binding Path=SLWithoutRate, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}"/>
                                <DataGridTextColumn Binding="{Binding Path=SLRate, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}"/>
                                <DataGridTextColumn Binding="{Binding Path=GTD.Specification.Parcel.RateDate, StringFormat=\{0:d\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentCenter}"/>
                                <DataGridTextColumn Binding="{Binding Path=GTD.Specification.Parcel.UsdRate, StringFormat=\{0:N4\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRight}"/>
                                <DataGridTextColumn Binding="{Binding Path=GTLSCur, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}"/>
                                <DataGridTextColumn Binding="{Binding Path=GTLS, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}"/>
                                <DataGridTextColumn Binding="{Binding Path=DDSpidy, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}"/>
                                <DataGridTextColumn Binding="{Binding Path=WestGate, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}"/>
                                <DataGridTextColumn Binding="{Binding Path=WestGateWithoutRate, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}"/>
                                <DataGridTextColumn Binding="{Binding Path=WestGateRate, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}"/>
                                <DataGridTextColumn Binding="{Binding Path=MFK, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}"/>
                                <DataGridTextColumn Binding="{Binding Path=MFKWithoutRate, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}"/>
                                <DataGridTextColumn Binding="{Binding Path=MFKRate, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}"/>
                                <DataGridTextColumn Binding="{Binding Path=CostLogistics, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}"/>
                                <DataGridTextColumn Binding="{Binding Path=CostTotal, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}"/>
                                <DataGridTextColumn Binding="{Binding Path=CostPer, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRight}"/>
                                <DataGridTextColumn Binding="{Binding Path=Profit, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}"/>
                                <DataGridTextColumn Binding="{Binding Path=ProfitAlgE, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}"/>
                                <DataGridTextColumn Binding="{Binding Path=ProfitAlgR, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}"/>
                                <DataGridTextColumn Binding="{Binding Path=ProfitDiff, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}"/>
                                <DataGridTextColumn Binding="{Binding Path=MarkupAlg, StringFormat=\{0:P0\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}"/>
                                <DataGridTextColumn Binding="{Binding Path=MarkupBU, StringFormat=\{0:P0\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRight}"/>
                                <DataGridTextColumn Binding="{Binding Path=MarkupTotal, StringFormat=\{0:P0\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRight}"/>
                                <DataGridTextColumn Binding="{Binding Path=Profitability, StringFormat=\{0:P0\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRight}"/>
                                <DataGridTextColumn Binding="{Binding Path=VATPay, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}"/>
                                <DataGridTextColumn Binding="{Binding Path=Volume, StringFormat=\{0:N3\}, TargetNullValue='', Mode=TwoWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}" EditingElementStyle="{StaticResource StyleTextBoxAlignmentRightTotal}"/>
                                <DataGridTextColumn Binding="{Binding Path=VolumeProfit, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRight}"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </DataTemplate>
                </DataGrid.RowDetailsTemplate>
                <DataGrid.RowStyle>
                    <Style TargetType="DataGridRow">
                        <Setter Property="DetailsVisibility" Value="{Binding Path=ClientsVisible}"/>
                    </Style>
                </DataGrid.RowStyle>
                <DataGrid.Columns>
                    <DataGridTextColumn Header="АМ" Binding="{Binding Path=Specification.Parcel.ParcelNumber, TargetNullValue='', Mode=OneWay}" SortMemberPath="Specification.Parcel.ParcelNumberOrder" Width="54" ElementStyle="{StaticResource StyleTextBlockAlignmentCenter}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="№ перевозки"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.ParcelFilter.IconVisibile, Mode=OneWay}"/>
                                                <TextBlock Text="{Binding}" FontWeight="Bold" VerticalAlignment="Center"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="ParcelFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                    </DataGridTextColumn>
                    <DataGridTemplateColumn Header="№ ГТД" SortMemberPath="Specification.Declaration.Number" ClipboardContentBinding="{Binding Path=Specification.Declaration.Number}" Width="150">
                        <DataGridTemplateColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="Номер таможенной декларации"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.DeclarationNumberFilter.IconVisibile, Mode=OneWay}"/>
                                                <TextBlock Text="{Binding}" FontWeight="Bold" VerticalAlignment="Center"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="DeclarationFilterPopup_Open"/>
                            </Style>
                        </DataGridTemplateColumn.HeaderStyle>
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="{Binding Path=Specification.Declaration.Number, TargetNullValue=''}" Margin="2,0"/>
                                    <Button Content="" ToolTip="Загрузка таможенной декларации" Command="{Binding Source={StaticResource DataContext}, Path=Data.TDLoad}" CommandParameter="{Binding}" Grid.Column="1" FontFamily="Segoe UI Symbol" Foreground="Green" Background="#f7e0e0" Visibility="{Binding Source={StaticResource keyVisibilityAccounts}, Path=Visibility, Mode=OneWay}"/>
                                </Grid>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                        <DataGridTemplateColumn.CellEditingTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBox Text="{Binding Path=Specification.Declaration.Number, TargetNullValue=''}" Margin="2,0"/>
                                    <Button Content="" ToolTip="Загрузка таможенной декларации" Command="{Binding Source={StaticResource DataContext}, Path=Data.TDLoad}" CommandParameter="{Binding}" Grid.Column="1" FontFamily="Segoe UI Symbol" Foreground="Green" Background="#f7e0e0"/>
                                </Grid>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellEditingTemplate>
                    </DataGridTemplateColumn>
                    <DataGridTextColumn Header="Поставщик" Binding="{Binding Path=Specification.Agent.Name, TargetNullValue='', Mode=OneWay}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.AgentFilter.IconVisibile, Mode=OneWay}"/>
                                                <TextBlock Text="{Binding}" FontWeight="Bold" VerticalAlignment="Center"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="AgentFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Дата реализации" Binding="{Binding SellingDate, Mode=TwoWay,TargetNullValue='', StringFormat=\{0:d\},UpdateSourceTrigger=LostFocus}" ElementStyle="{StaticResource StyleTextBlockAlignmentCenter}" EditingElementStyle="{StaticResource StyleTextBoxAlignmentCenterErr}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="Дата реализации"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.SellingDateFilter.IconVisibile, Mode=OneWay}"/>
                                                <TextBlock Text="{Binding}" FontWeight="Bold" TextWrapping="Wrap" VerticalAlignment="Center"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="SellingDateFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Cумма реализации" Binding="{Binding Path=Selling, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="Cумма реализации"/>
                                <Setter Property="HorizontalContentAlignment" Value="Right"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <Grid HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition/>
                                                    <RowDefinition/>
                                                </Grid.RowDefinitions>
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.SellingFilter.IconVisibile, Mode=OneWay}"/>
                                                    <TextBlock Text="{Binding}" FontWeight="Bold" TextWrapping="Wrap"/>
                                                </StackPanel>
                                                <TextBox Text="{Binding Source={StaticResource DataContext},Path=Data.Total.Selling, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" IsReadOnly="True" Grid.Row="1" Margin="0" Padding="0" BorderThickness="0" Background="Transparent" HorizontalAlignment="Right" FontWeight="Bold"/>
                                            </Grid>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="SellingFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                <Setter Property="Padding" Value="0,0,4,0"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Сумма реализации без ндс" Binding="{Binding Path=SellingWithoutRate, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" Width="90">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="Сумма реализации без ндс"/>
                                <Setter Property="HorizontalContentAlignment" Value="Right"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <Grid HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition/>
                                                    <RowDefinition/>
                                                </Grid.RowDefinitions>
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.SellingWithoutRateFilter.IconVisibile, Mode=OneWay}"/>
                                                    <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                                </StackPanel>
                                                <TextBox Text="{Binding Source={StaticResource DataContext},Path=Data.Total.SellingWithoutRate, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" IsReadOnly="True" Grid.Row="1" Margin="0" Padding="0" BorderThickness="0" Background="Transparent" HorizontalAlignment="Right" FontWeight="Bold"/>
                                            </Grid>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="SellingWithoutRateFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                <Setter Property="Padding" Value="0,0,4,0"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="НДС с реализации" Binding="{Binding Path=SellingRate, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" Width="90">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="НДС с реализации"/>
                                <Setter Property="HorizontalContentAlignment" Value="Right"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <Grid HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition/>
                                                    <RowDefinition/>
                                                </Grid.RowDefinitions>
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.SellingRateFilter.IconVisibile, Mode=OneWay}"/>
                                                    <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                                </StackPanel>
                                                <TextBox Text="{Binding Source={StaticResource DataContext},Path=Data.Total.SellingRate, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" IsReadOnly="True" Grid.Row="1" Margin="0" Padding="0" BorderThickness="0" Background="Transparent" HorizontalAlignment="Right" FontWeight="Bold"/>
                                            </Grid>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="SellingRateFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                <Setter Property="Padding" Value="0,0,4,0"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Покупатель" Binding="{Binding Path=Client.Name, TargetNullValue='', Mode=OneWay}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="Покупатель"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.ClientFilter.IconVisibile, Mode=OneWay}"/>
                                                <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="ClientFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                        <DataGridTextColumn.CellStyle>
                            <Style TargetType="DataGridCell">
                                <Setter Property="ToolTip" Value="{Binding RelativeSource={RelativeSource Self}, Path=Content.Text}"/>
                                <Setter Property="FontWeight" Value="{Binding Client.NameFontWeight}"/>
                            </Style>
                        </DataGridTextColumn.CellStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Коэф-нт" Binding="{Binding Path=Rate, TargetNullValue='', Mode=OneWay}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="Коэффициент"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.RateFilter.IconVisibile, Mode=OneWay}"/>
                                                <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="RateFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Сбор" Binding="{Binding Specification.Declaration.Fee, Mode=TwoWay, StringFormat=\{0:N2\},TargetNullValue='',UpdateSourceTrigger=PropertyChanged}" EditingElementStyle="{StaticResource StyleTextBoxAlignmentRightTotal}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="Сбор"/>
                                <Setter Property="HorizontalContentAlignment" Value="Right"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <Grid HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition/>
                                                    <RowDefinition/>
                                                </Grid.RowDefinitions>
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.FeeFilter.IconVisibile, Mode=OneWay}"/>
                                                    <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                                </StackPanel>
                                                <TextBox Text="{Binding Source={StaticResource DataContext},Path=Data.Total.Fee, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" IsReadOnly="True" Grid.Row="1" Margin="0" Padding="0" BorderThickness="0" Background="Transparent" HorizontalAlignment="Right" FontWeight="Bold"/>
                                            </Grid>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="FeeFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                <Setter Property="Padding" Value="0,0,4,0"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Пошлина" Binding="{Binding Path=Specification.Declaration.Tax, TargetNullValue='', Mode=TwoWay, StringFormat=\{0:N2\},UpdateSourceTrigger=PropertyChanged}" EditingElementStyle="{StaticResource StyleTextBoxAlignmentRightTotal}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="Пошлина"/>
                                <Setter Property="HorizontalContentAlignment" Value="Right"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <Grid HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition/>
                                                    <RowDefinition/>
                                                </Grid.RowDefinitions>
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.TaxFilter.IconVisibile, Mode=OneWay}"/>
                                                    <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                                </StackPanel>
                                                <TextBox Text="{Binding Source={StaticResource DataContext},Path=Data.Total.Tax, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" IsReadOnly="True" Grid.Row="1" Margin="0" Padding="0" BorderThickness="0" Background="Transparent" HorizontalAlignment="Right" FontWeight="Bold"/>
                                            </Grid>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="TaxFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                <Setter Property="Padding" Value="0,0,4,0"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="НДС" Binding="{Binding Path=Specification.Declaration.VAT, TargetNullValue='', Mode=TwoWay, StringFormat=\{0:N2\}}" EditingElementStyle="{StaticResource StyleTextBoxAlignmentRightTotal}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="НДС"/>
                                <Setter Property="HorizontalContentAlignment" Value="Right"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <Grid HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition/>
                                                    <RowDefinition/>
                                                </Grid.RowDefinitions>
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.VATFilter.IconVisibile, Mode=OneWay}"/>
                                                    <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                                </StackPanel>
                                                <TextBox Text="{Binding Source={StaticResource DataContext},Path=Data.Total.VAT, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" IsReadOnly="True" Grid.Row="1" Margin="0" Padding="0" BorderThickness="0" Background="Transparent" HorizontalAlignment="Right" FontWeight="Bold"/>
                                            </Grid>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="VATFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                <Setter Property="Padding" Value="0,0,4,0"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Стоимость в валюте" Binding="{Binding Path=Specification.Declaration.TotalSum, StringFormat=\{0:N2\}, TargetNullValue='', Mode=TwoWay}" EditingElementStyle="{StaticResource StyleTextBoxAlignmentRightTotal}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="Стоимость в валюте"/>
                                <Setter Property="HorizontalContentAlignment" Value="Right"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <Grid HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition/>
                                                    <RowDefinition/>
                                                </Grid.RowDefinitions>
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.TotalSumFilter.IconVisibile, Mode=OneWay}"/>
                                                    <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                                </StackPanel>
                                                <TextBox Text="{Binding Source={StaticResource DataContext},Path=Data.Total.DTSum, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" IsReadOnly="True" Grid.Row="1" Margin="0" Padding="0" BorderThickness="0" Background="Transparent" HorizontalAlignment="Right" FontWeight="Bold"/>
                                            </Grid>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="TotalSumFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                <Setter Property="Padding" Value="0,0,4,0"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Курс ДТ/Курс покупки валюты" Binding="{Binding Path=Specification.Declaration.CBRate, StringFormat=\{0:N4\}, TargetNullValue='', Mode=TwoWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRight}" EditingElementStyle="{StaticResource StyleTextBoxAlignmentRight}" Width="90">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="Курс ДТ/Курс покупки валюты"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.DTRateFilter.IconVisibile, Mode=OneWay}"/>
                                                <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="DTRateFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Стоимость рублей" Binding="{Binding Path=DTSumRub, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="HorizontalContentAlignment" Value="Right"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <Grid HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition/>
                                                    <RowDefinition/>
                                                </Grid.RowDefinitions>
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.DTSumRubFilter.IconVisibile, Mode=OneWay}"/>
                                                    <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                                </StackPanel>
                                                <TextBox Text="{Binding Source={StaticResource DataContext},Path=Data.Total.DTSumRub, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" IsReadOnly="True" Grid.Row="1" Margin="0" Padding="0" BorderThickness="0" Background="Transparent" HorizontalAlignment="Right" FontWeight="Bold"/>
                                            </Grid>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="DTSumRubFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="С/С" Binding="{Binding Path=CC, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="HorizontalContentAlignment" Value="Right"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <Grid HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition/>
                                                    <RowDefinition/>
                                                </Grid.RowDefinitions>
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.CCFilter.IconVisibile, Mode=OneWay}"/>
                                                    <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                                </StackPanel>
                                                <TextBox Text="{Binding Source={StaticResource DataContext},Path=Data.Total.CC, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" IsReadOnly="True" Grid.Row="1" Margin="0" Padding="0" BorderThickness="0" Background="Transparent" HorizontalAlignment="Right" FontWeight="Bold"/>
                                            </Grid>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="CCFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="СК ПАРИ" Binding="{Binding Path=Specification.Pari, StringFormat=\{0:N2\}, Mode=TwoWay, TargetNullValue='',UpdateSourceTrigger=PropertyChanged}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}" EditingElementStyle="{StaticResource StyleTextBoxAlignmentRightTotal}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="СК ПАРИ"/>
                                <Setter Property="HorizontalContentAlignment" Value="Right"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <Grid HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition/>
                                                    <RowDefinition/>
                                                </Grid.RowDefinitions>
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.PariFilter.IconVisibile, Mode=OneWay}"/>
                                                    <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                                </StackPanel>
                                                <TextBox Text="{Binding Source={StaticResource DataContext},Path=Data.Total.Pari, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" IsReadOnly="True" Grid.Row="1" Margin="0" Padding="0" BorderThickness="0" Background="Transparent" HorizontalAlignment="Right" FontWeight="Bold"/>
                                            </Grid>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="PariFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="СЛ" Binding="{Binding Path=SL, StringFormat=\{0:N2\}, TargetNullValue='', Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}" EditingElementStyle="{StaticResource StyleTextBoxAlignmentRightTotal}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="СЛ"/>
                                <Setter Property="HorizontalContentAlignment" Value="Right"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <Grid HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition/>
                                                    <RowDefinition/>
                                                </Grid.RowDefinitions>
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.SLFilter.IconVisibile, Mode=OneWay}"/>
                                                    <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                                </StackPanel>
                                                <TextBox Text="{Binding Source={StaticResource DataContext},Path=Data.Total.SL, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" IsReadOnly="True" Grid.Row="1" Margin="0" Padding="0" BorderThickness="0" Background="Transparent" HorizontalAlignment="Right" FontWeight="Bold"/>
                                            </Grid>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="SLFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="СЛ без НДС" Binding="{Binding Path=SLWithoutRate, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="СЛ без НДС"/>
                                <Setter Property="HorizontalContentAlignment" Value="Right"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <Grid HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition/>
                                                    <RowDefinition/>
                                                </Grid.RowDefinitions>
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.SLWithoutRateFilter.IconVisibile, Mode=OneWay}"/>
                                                    <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                                </StackPanel>
                                                <TextBox Text="{Binding Source={StaticResource DataContext},Path=Data.Total.SLWithoutRate, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" IsReadOnly="True" Grid.Row="1" Margin="0" Padding="0" BorderThickness="0" Background="Transparent" HorizontalAlignment="Right" FontWeight="Bold"/>
                                            </Grid>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="SLWithoutRateFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="СЛ НДС" Binding="{Binding Path=SLRate, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="СЛ НДС"/>
                                <Setter Property="HorizontalContentAlignment" Value="Right"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <Grid HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition/>
                                                    <RowDefinition/>
                                                </Grid.RowDefinitions>
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.SLRateFilter.IconVisibile, Mode=OneWay}"/>
                                                    <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                                </StackPanel>
                                                <TextBox Text="{Binding Source={StaticResource DataContext},Path=Data.Total.SLRate, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" IsReadOnly="True" Grid.Row="1" Margin="0" Padding="0" BorderThickness="0" Background="Transparent" HorizontalAlignment="Right" FontWeight="Bold"/>
                                            </Grid>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="SLRateFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="ГТЛС дата" Binding="{Binding Specification.Parcel.RateDate, Mode=TwoWay,TargetNullValue='', StringFormat=\{0:d\},UpdateSourceTrigger=LostFocus}" ElementStyle="{StaticResource StyleTextBlockAlignmentCenter}" EditingElementStyle="{StaticResource StyleTextBoxAlignmentCenterErr}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="Дата ГТЛС"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.GTLSDateFilter.IconVisibile, Mode=OneWay}"/>
                                                <TextBlock Text="{Binding}" FontWeight="Bold" TextWrapping="Wrap" VerticalAlignment="Center"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="GTLSDateFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="ГТЛС курс" Binding="{Binding Path=Specification.Parcel.UsdRate, StringFormat=\{0:N4\}, Mode=TwoWay, TargetNullValue='',UpdateSourceTrigger=PropertyChanged}" ElementStyle="{StaticResource StyleTextBlockAlignmentRight}" EditingElementStyle="{StaticResource StyleTextBoxAlignmentRight}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="ГТЛС"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.GTLSRateFilter.IconVisibile, Mode=OneWay}"/>
                                                <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="GTLSRateFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="ГТЛС евро" Binding="{Binding Path=Specification.GTLSCur, StringFormat=\{0:N2\}, Mode=TwoWay, TargetNullValue='',UpdateSourceTrigger=PropertyChanged}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}" EditingElementStyle="{StaticResource StyleTextBoxAlignmentRightTotal}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="ГТЛС евро"/>
                                <Setter Property="HorizontalContentAlignment" Value="Right"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <Grid HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition/>
                                                    <RowDefinition/>
                                                </Grid.RowDefinitions>
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.GTLSCurFilter.IconVisibile, Mode=OneWay}"/>
                                                    <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                                </StackPanel>
                                                <TextBox Text="{Binding Source={StaticResource DataContext},Path=Data.Total.GTLSCur, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" IsReadOnly="True" Grid.Row="1" Margin="0" Padding="0" BorderThickness="0" Background="Transparent" HorizontalAlignment="Right" FontWeight="Bold"/>
                                            </Grid>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="GTLSCurFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="ГТЛС руб" Binding="{Binding Path=Specification.GTLS, StringFormat=\{0:N2\}, Mode=TwoWay, TargetNullValue='',UpdateSourceTrigger=PropertyChanged}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}" EditingElementStyle="{StaticResource StyleTextBoxAlignmentRightTotal}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="ГТЛС"/>
                                <Setter Property="HorizontalContentAlignment" Value="Right"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <Grid HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition/>
                                                    <RowDefinition/>
                                                </Grid.RowDefinitions>
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.GTLSFilter.IconVisibile, Mode=OneWay}"/>
                                                    <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                                </StackPanel>
                                                <TextBox Text="{Binding Source={StaticResource DataContext},Path=Data.Total.GTLS, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" IsReadOnly="True" Grid.Row="1" Margin="0" Padding="0" BorderThickness="0" Background="Transparent" HorizontalAlignment="Right" FontWeight="Bold"/>
                                            </Grid>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="GTLSFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="ДД спиди" Binding="{Binding Path=Specification.DDSpidy, StringFormat=\{0:N2\}, Mode=TwoWay, TargetNullValue='',UpdateSourceTrigger=PropertyChanged}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}" EditingElementStyle="{StaticResource StyleTextBoxAlignmentRightTotal}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="ДД спиди"/>
                                <Setter Property="HorizontalContentAlignment" Value="Right"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <Grid HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition/>
                                                    <RowDefinition/>
                                                </Grid.RowDefinitions>
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.DDSpidyFilter.IconVisibile, Mode=OneWay}"/>
                                                    <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                                </StackPanel>
                                                <TextBox Text="{Binding Source={StaticResource DataContext},Path=Data.Total.DDSpidy, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" IsReadOnly="True" Grid.Row="1" Margin="0" Padding="0" BorderThickness="0" Background="Transparent" HorizontalAlignment="Right" FontWeight="Bold"/>
                                            </Grid>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="DDSpidyFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Западные ворота" Binding="{Binding Path=Specification.WestGate, StringFormat=\{0:N2\}, Mode=TwoWay, TargetNullValue='',UpdateSourceTrigger=PropertyChanged}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}" EditingElementStyle="{StaticResource StyleTextBoxAlignmentRightTotal}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="Западные ворота"/>
                                <Setter Property="HorizontalContentAlignment" Value="Right"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <Grid HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition/>
                                                    <RowDefinition/>
                                                </Grid.RowDefinitions>
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.WestGateFilter.IconVisibile, Mode=OneWay}"/>
                                                    <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                                </StackPanel>
                                                <TextBox Text="{Binding Source={StaticResource DataContext},Path=Data.Total.WestGate, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" IsReadOnly="True" Grid.Row="1" Margin="0" Padding="0" BorderThickness="0" Background="Transparent" HorizontalAlignment="Right" FontWeight="Bold"/>
                                            </Grid>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="WestGateFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="без НДС Западные ворота" Binding="{Binding Path=Specification.WestGateWithoutRate, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="Западные ворота без НДС"/>
                                <Setter Property="HorizontalContentAlignment" Value="Right"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <Grid HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition/>
                                                    <RowDefinition/>
                                                </Grid.RowDefinitions>
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.WestGateWithoutRateFilter.IconVisibile, Mode=OneWay}"/>
                                                    <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                                </StackPanel>
                                                <TextBox Text="{Binding Source={StaticResource DataContext},Path=Data.Total.WestGateWithoutRate, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" IsReadOnly="True" Grid.Row="1" Margin="0" Padding="0" BorderThickness="0" Background="Transparent" HorizontalAlignment="Right" FontWeight="Bold"/>
                                            </Grid>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="WestGateWithoutRateFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="НДС Западные ворота" Binding="{Binding Path=Specification.WestGateRate, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="Западные ворота НДС"/>
                                <Setter Property="HorizontalContentAlignment" Value="Right"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <Grid HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition/>
                                                    <RowDefinition/>
                                                </Grid.RowDefinitions>
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.WestGateRateFilter.IconVisibile, Mode=OneWay}"/>
                                                    <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                                </StackPanel>
                                                <TextBox Text="{Binding Source={StaticResource DataContext},Path=Data.Total.WestGateRate, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" IsReadOnly="True" Grid.Row="1" Margin="0" Padding="0" BorderThickness="0" Background="Transparent" HorizontalAlignment="Right" FontWeight="Bold"/>
                                            </Grid>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="WestGateRateFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="МФК" Binding="{Binding Path=Specification.MFK, StringFormat=\{0:N2\}, Mode=TwoWay, TargetNullValue='',UpdateSourceTrigger=PropertyChanged}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}" EditingElementStyle="{StaticResource StyleTextBoxAlignmentRightTotal}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="МФК"/>
                                <Setter Property="HorizontalContentAlignment" Value="Right"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <Grid HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition/>
                                                    <RowDefinition/>
                                                </Grid.RowDefinitions>
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.MFKFilter.IconVisibile, Mode=OneWay}"/>
                                                    <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                                </StackPanel>
                                                <TextBox Text="{Binding Source={StaticResource DataContext},Path=Data.Total.MFK, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" IsReadOnly="True" Grid.Row="1" Margin="0" Padding="0" BorderThickness="0" Background="Transparent" HorizontalAlignment="Right" FontWeight="Bold"/>
                                            </Grid>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="MFKFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="МФК без НДС" Binding="{Binding Path=Specification.MFKWithoutRate, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="МФК без НДС"/>
                                <Setter Property="HorizontalContentAlignment" Value="Right"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <Grid HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition/>
                                                    <RowDefinition/>
                                                </Grid.RowDefinitions>
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.MFKWithoutRateFilter.IconVisibile, Mode=OneWay}"/>
                                                    <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                                </StackPanel>
                                                <TextBox Text="{Binding Source={StaticResource DataContext},Path=Data.Total.MFKWithoutRate, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" IsReadOnly="True" Grid.Row="1" Margin="0" Padding="0" BorderThickness="0" Background="Transparent" HorizontalAlignment="Right" FontWeight="Bold"/>
                                            </Grid>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="MFKWithoutRateFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="МФК НДС" Binding="{Binding Path=Specification.MFKRate, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="МФК НДС"/>
                                <Setter Property="HorizontalContentAlignment" Value="Right"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <Grid HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition/>
                                                    <RowDefinition/>
                                                </Grid.RowDefinitions>
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.MFKRateFilter.IconVisibile, Mode=OneWay}"/>
                                                    <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                                </StackPanel>
                                                <TextBox Text="{Binding Source={StaticResource DataContext},Path=Data.Total.MFKRate, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" IsReadOnly="True" Grid.Row="1" Margin="0" Padding="0" BorderThickness="0" Background="Transparent" HorizontalAlignment="Right" FontWeight="Bold"/>
                                            </Grid>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="MFKRateFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Затраты логистика без НДС" Binding="{Binding Path=CostLogistics, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}" Width="90">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="Затраты логистика без НДС"/>
                                <Setter Property="HorizontalContentAlignment" Value="Right"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <Grid HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition/>
                                                    <RowDefinition/>
                                                </Grid.RowDefinitions>
                                                <StackPanel Orientation="Horizontal" Background="#FFDAEEF3">
                                                    <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.CostLogisticsFilter.IconVisibile, Mode=OneWay}"/>
                                                    <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                                </StackPanel>
                                                <TextBox Text="{Binding Source={StaticResource DataContext},Path=Data.Total.CostLogistics, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" IsReadOnly="True" Grid.Row="1" Margin="0" Padding="0" BorderThickness="0" Background="Transparent" HorizontalAlignment="Right" FontWeight="Bold"/>
                                            </Grid>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="CostLogisticsFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Общие затраты" Binding="{Binding Path=CostTotal, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="Общие затраты"/>
                                <Setter Property="HorizontalContentAlignment" Value="Right"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <Grid HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition/>
                                                    <RowDefinition/>
                                                </Grid.RowDefinitions>
                                                <StackPanel Orientation="Horizontal" Background="#FFDAEEF3">
                                                    <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.CostTotalFilter.IconVisibile, Mode=OneWay}"/>
                                                    <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                                </StackPanel>
                                                <TextBox Text="{Binding Source={StaticResource DataContext},Path=Data.Total.CostTotal, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" IsReadOnly="True" Grid.Row="1" Margin="0" Padding="0" BorderThickness="0" Background="Transparent" HorizontalAlignment="Right" FontWeight="Bold"/>
                                            </Grid>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="CostTotalFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="% затрат к реализации" Binding="{Binding Path=CostPer, StringFormat=\{0:P2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRight}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="% затрат к реализации"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal" Background="#FFDAEEF3">
                                                <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.CostPerFilter.IconVisibile, Mode=OneWay}"/>
                                                <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="CostPerFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Прибыль" Binding="{Binding Path=Profit, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="Прибыль"/>
                                <Setter Property="HorizontalContentAlignment" Value="Right"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <Grid HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition/>
                                                    <RowDefinition/>
                                                </Grid.RowDefinitions>
                                                <StackPanel Orientation="Horizontal" Background="#FFF2DCDB">
                                                    <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.ProfitFilter.IconVisibile, Mode=OneWay}"/>
                                                    <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                                </StackPanel>
                                                <TextBox Text="{Binding Source={StaticResource DataContext},Path=Data.Total.Profit, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" IsReadOnly="True" Grid.Row="1" Margin="0" Padding="0" BorderThickness="0" Background="Transparent" HorizontalAlignment="Right" FontWeight="Bold"/>
                                            </Grid>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="ProfitFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Доход в евро" Binding="{Binding Path=ProfitAlgE, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="Доход по алгоритму в евро"/>
                                <Setter Property="HorizontalContentAlignment" Value="Right"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <Grid HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition/>
                                                    <RowDefinition/>
                                                </Grid.RowDefinitions>
                                                <StackPanel Orientation="Horizontal" Background="#FFF2DCDB">
                                                    <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.ProfitAlgEFilter.IconVisibile, Mode=OneWay}"/>
                                                    <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                                </StackPanel>
                                                <TextBox Text="{Binding Source={StaticResource DataContext},Path=Data.Total.ProfitAlgE, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" IsReadOnly="True" Grid.Row="1" Margin="0" Padding="0" BorderThickness="0" Background="Transparent" HorizontalAlignment="Right" FontWeight="Bold"/>
                                            </Grid>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="ProfitAlgEFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Доход в руб" Binding="{Binding Path=ProfitAlgR, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="Доход по алгоритму в руб"/>
                                <Setter Property="HorizontalContentAlignment" Value="Right"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <Grid HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition/>
                                                    <RowDefinition/>
                                                </Grid.RowDefinitions>
                                                <StackPanel Orientation="Horizontal" Background="#FFF2DCDB">
                                                    <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.ProfitAlgRFilter.IconVisibile, Mode=OneWay}"/>
                                                    <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                                </StackPanel>
                                                <TextBox Text="{Binding Source={StaticResource DataContext},Path=Data.Total.ProfitAlgR, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" IsReadOnly="True" Grid.Row="1" Margin="0" Padding="0" BorderThickness="0" Background="Transparent" HorizontalAlignment="Right" FontWeight="Bold"/>
                                            </Grid>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="ProfitAlgRFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Разница План/Факт" Binding="{Binding Path=ProfitDiff, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="Разница План/Факт"/>
                                <Setter Property="HorizontalContentAlignment" Value="Right"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <Grid HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition/>
                                                    <RowDefinition/>
                                                </Grid.RowDefinitions>
                                                <StackPanel Orientation="Horizontal" Background="#FFF2DCDB">
                                                    <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.ProfitDiffFilter.IconVisibile, Mode=OneWay}"/>
                                                    <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                                </StackPanel>
                                                <TextBox Text="{Binding Source={StaticResource DataContext},Path=Data.Total.ProfitDiff, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" IsReadOnly="True" Grid.Row="1" Margin="0" Padding="0" BorderThickness="0" Background="Transparent" HorizontalAlignment="Right" FontWeight="Bold"/>
                                            </Grid>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="ProfitDiffFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="% по алгоритму" Binding="{Binding Path=MarkupAlg, StringFormat=\{0:P0\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="% наценки по алгоритму"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.MarkupAlgFilter.IconVisibile, Mode=OneWay}"/>
                                                <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="MarkupAlgFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="% по БУ" Binding="{Binding Path=MarkupBU, StringFormat=\{0:P0\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRight}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="% наценки к с/с товара по БУ"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.MarkupBUFilter.IconVisibile, Mode=OneWay}"/>
                                                <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="MarkupBUFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="% к полной с/с товара" Binding="{Binding Path=MarkupTotal, StringFormat=\{0:P0\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRight}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="% наценки к полной с/с товара"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.MarkupTotalFilter.IconVisibile, Mode=OneWay}"/>
                                                <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="MarkupTotalFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Кофф, рентабельности продаж" Binding="{Binding Path=Profitability, StringFormat=\{0:P0\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRight}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="Кофф, рентабельности продаж"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.ProfitabilityFilter.IconVisibile, Mode=OneWay}"/>
                                                <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="ProfitabilityFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="НДС к уплате" Binding="{Binding Path=VATPay, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="НДС к уплате"/>
                                <Setter Property="HorizontalContentAlignment" Value="Right"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <Grid HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition/>
                                                    <RowDefinition/>
                                                </Grid.RowDefinitions>
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.VATPayFilter.IconVisibile, Mode=OneWay}"/>
                                                    <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                                </StackPanel>
                                                <TextBox Text="{Binding Source={StaticResource DataContext},Path=Data.Total.VATPay, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" IsReadOnly="True" Grid.Row="1" Margin="0" Padding="0" BorderThickness="0" Background="Transparent" HorizontalAlignment="Right" FontWeight="Bold"/>
                                            </Grid>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="VATPayFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Кубы" Binding="{Binding Path=Volume, StringFormat=\{0:N4\}, TargetNullValue='', Mode=TwoWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRightTotal}" EditingElementStyle="{StaticResource StyleTextBoxAlignmentRightTotal}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="Кубы"/>
                                <Setter Property="HorizontalContentAlignment" Value="Right"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <Grid HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition/>
                                                    <RowDefinition/>
                                                </Grid.RowDefinitions>
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.VolumeFilter.IconVisibile, Mode=OneWay}"/>
                                                    <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                                </StackPanel>
                                                <TextBox Text="{Binding Source={StaticResource DataContext},Path=Data.Total.Volume, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" IsReadOnly="True" Grid.Row="1" Margin="0" Padding="0" BorderThickness="0" Background="Transparent" HorizontalAlignment="Right" FontWeight="Bold"/>
                                            </Grid>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="VolumeFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Прибыль на 1 куб" Binding="{Binding Path=VolumeProfit, StringFormat=\{0:N2\}, TargetNullValue='', Mode=OneWay}" ElementStyle="{StaticResource StyleTextBlockAlignmentRight}">
                        <DataGridTextColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                                <Setter Property="ToolTip" Value="Прибыль на 1 куб"/>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Image Source="/CustomBrokerWpf;component/Images/funnel.png" Height="10" VerticalAlignment="Center" Margin="0,0,4,0" Visibility="{Binding Source={StaticResource DataContext}, Path=Data.VolumeProfitFilter.IconVisibile, Mode=OneWay}"/>
                                                <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <EventSetter Event="MouseRightButtonUp" Handler="VolumeProfitFilterPopup_Open"/>
                            </Style>
                        </DataGridTextColumn.HeaderStyle>
                    </DataGridTextColumn>
                </DataGrid.Columns>
            </DataGrid>
        </ScrollViewer>
    </Grid>
</UserControl>
