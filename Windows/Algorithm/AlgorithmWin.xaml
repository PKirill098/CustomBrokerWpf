<Window x:Class="KirillPolyanskiy.CustomBrokerWpf.AlgorithmWin"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:KirillPolyanskiy.CustomBrokerWpf"
        xmlns:lib="clr-namespace:KirillPolyanskiy.DataModelClassLibrary;assembly=DataModelClassLibrary"
        mc:Ignorable="d"
        Title="Алгоритмы" Name="winAlgorithm" DataContextChanged="Window_DataContextChanged" Closing="Window_Closing" Height="600" Width="1200" WindowState="Maximized" Language="ru-RU" FontSize="11" Icon="/CustomBrokerWpf;component/Images/calculator.png" >
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="32"/>
            <RowDefinition/>
        </Grid.RowDefinitions>
        <ToolBar IsTabStop="False" Height="32">
            <Button ToolTip="Добавить формулу в первый раздел" Command="{Binding Path=Add}" CommandParameter="1" IsTabStop="False" Visibility="{Binding Path=WriterMenuVisible}">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="✚" FontFamily="Segoe UI Symbol" FontSize="14" Foreground="Green" FontWeight="Bold" VerticalAlignment="Center"/>
                    <TextBlock Text="Ф1" FontSize="18" Foreground="Green" FontWeight="Bold" VerticalAlignment="Center"/>
                </StackPanel>
            </Button>
            <Button ToolTip="Добавить формулу во второй раздел" Command="{Binding Path=Add}" CommandParameter="2" IsTabStop="False" Visibility="{Binding Path=WriterMenuVisible}">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="✚" FontFamily="Segoe UI Symbol" FontSize="14" Foreground="Green" FontWeight="Bold" VerticalAlignment="Center"/>
                    <TextBlock Text="Ф2" FontSize="18" Foreground="Green" FontWeight="Bold" VerticalAlignment="Center"/>
                </StackPanel>
            </Button>
            <Button ToolTip="Добавить алгоритм" Command="{Binding Path=AddAlgorithm}" Click="AddAlgorithm_Click" IsTabStop="False" Visibility="{Binding Path=WriterMenuVisible}">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="✚" FontFamily="Segoe UI Symbol" FontSize="14" Foreground="Green" FontWeight="Bold" VerticalAlignment="Center"/>
                    <TextBlock Text="А" FontSize="18" Foreground="Green" FontWeight="Bold" VerticalAlignment="Center"/>
                </StackPanel>
            </Button>
            <Button ToolTip="Удалить выделенную формулу" Command="Delete" IsTabStop="False" Visibility="{Binding Path=WriterMenuVisible}">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="❌" FontFamily="Segoe UI Symbol" FontSize="12" Foreground="Red" FontWeight="Bold" VerticalAlignment="Center"/>
                    <TextBlock Text="Ф" FontSize="18" Foreground="Red" FontWeight="Bold" VerticalAlignment="Center"/>
                </StackPanel>
            </Button>
            <Button ToolTip="Удалить алгоритм, текущей ячейки" Command="Cut" IsTabStop="False" Visibility="{Binding Path=WriterMenuVisible}">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="❌" FontFamily="Segoe UI Symbol" FontSize="12" Foreground="Red" FontWeight="Bold" VerticalAlignment="Center"/>
                    <TextBlock Text="А" FontSize="18" Foreground="Red" FontWeight="Bold" VerticalAlignment="Center"/>
                </StackPanel>
            </Button>
            <Separator Visibility="{Binding Path=WriterMenuVisible}"/>
            <Button Command="Copy" ToolTip="Копировать" IsTabStop="False">
                <Image Source="/CustomBrokerWpf;component/Images/copy.png" />
            </Button>
            <Separator Visibility="Collapsed"/>
            <Button ToolTip="в Excel" Command="{Binding CreateExcelReport}" Visibility="Collapsed">
                <Image Source="/CustomBrokerWpf;component/Images/vexcel4.png" />
            </Button>
            <Separator/>
            <Button ToolTip="Обновить данные" Command="{Binding SaveRefresh}" Visibility="Visible">
                <Image Source="/CustomBrokerWpf;component/Images/r2Refresh-512.png" />
            </Button>
            <Button ToolTip="Сохранить изменения в БД" Command="{Binding Save}" IsTabStop="False" Visibility="{Binding Path=SaveMenuVisible}">
                <Image Source="/CustomBrokerWpf;component/Images/Save.png" />
            </Button>
            <Button ToolTip="Отменить несохраненные изменения" Command="{Binding Reject}" Visibility="{Binding Path=SaveMenuVisible}" >
                <Image Source="/CustomBrokerWpf;component/Images/rRemove-512.png" />
            </Button>
            <Separator/>
            <Button Content="Закрыть" Click="CloseButton_Clic"/>
            <Popup IsOpen="{Binding Path=PopupIsOpen}" StaysOpen="False" Placement="Bottom" PopupAnimation="Fade" AllowsTransparency="True" Visibility="Collapsed" IsHitTestVisible="False" >
                <Border BorderBrush="Beige" BorderThickness="2" Background="{Binding Path=PopupBackground}" CornerRadius="7">
                    <TextBlock Text="{Binding Path=PopupText}" Margin="2"  FontStyle="Italic" Foreground="Teal" />
                </Border>
            </Popup>
        </ToolBar>
        <ScrollViewer Grid.Row="1" Margin="2" HorizontalScrollBarVisibility="Auto">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid.Resources>
                    <lib:BindingProxy x:Key="MainData" Data="{Binding}"/>
                </Grid.Resources>
                <DataGrid Grid.Row="0" x:Name="DataGrid1" ItemsSource="{Binding View1}" HeadersVisibility="Column" SelectedIndex="-1" CanUserAddRows="False" CanUserDeleteRows="False" CanUserReorderColumns="False" CanUserSortColumns="False" RowDetailsVisibilityMode="Collapsed" AutoGenerateColumns="False" RowHeaderWidth="15" CanUserResizeRows="False" FrozenColumnCount="4" HorizontalAlignment="Left" ClipboardCopyMode="IncludeHeader"
                    VerticalGridLinesBrush="Transparent" HorizontalGridLinesBrush="Transparent" BorderThickness="0" BorderBrush="{x:Null}" GridLinesVisibility="None" Background="White" HorizontalScrollBarVisibility="Disabled"
                    SizeChanged="DataGrid1_SizeChanged">
                    <DataGrid.CommandBindings>
                        <CommandBinding Command="{x:Static ApplicationCommands.Delete}" 
                            CanExecute="Delete_CanExecute"
                            Executed="Delete_Execute" />
                        <CommandBinding Command="{x:Static ApplicationCommands.Cut}" 
                            CanExecute="DeleteAlgorithm_CanExecute"
                            Executed="DeleteAlgorithm_Execute" />
                    </DataGrid.CommandBindings>
                    <DataGrid.Resources>
                        <LinearGradientBrush x:Key="HeaderBrush" StartPoint="0.5,0" EndPoint="0.5,1">
                            <GradientStop Color="#FFFCD5B4" Offset="0"/>
                            <GradientStop Color="#FFFBE4D0" Offset="0.5"/>
                            <GradientStop Color="#FFFCD5B4" Offset="1"/>
                        </LinearGradientBrush>
                        <Style x:Key="AlgorithmHeaderStyle" TargetType="DataGridColumnHeader">
                            <Setter Property="Background" Value="{StaticResource HeaderBrush}"/>
                            <Setter Property="BorderBrush" Value="Black"/>
                            <Setter Property="BorderThickness" Value="2,2,2,1"/>
                            <Setter Property="Margin" Value="6,0,0,0"/>
                            <Setter Property="HorizontalContentAlignment" Value="Center"/>
                            <EventSetter Event="PreviewMouseLeftButtonDown" Handler="AlgorithmHeader_MouseLeftButtonUp"/>
                        </Style>
                        <Style x:Key="AlgorithmCellStyle" TargetType="DataGridCell">
                            <Setter Property="BorderBrush" Value="Black"/>
                            <Setter Property="BorderThickness" Value="2,0,2,1"/>
                            <Setter Property="Margin" Value="6,0,0,0"/>
                            <Style.Triggers>
                                <Trigger Property="IsSelected" Value="False">
                                    <Setter Property="Background" Value="#FFFFF0E4"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </DataGrid.Resources>
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="№" Binding="{Binding Path=Formula.Code, UpdateSourceTrigger=LostFocus}" Width="40" ElementStyle="{StaticResource StyleTextBlockAlignmentCenterErr}" EditingElementStyle="{StaticResource StyleTextBoxAlignmentCenter}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.FormulaIsReadOnly}">
                            <DataGridTextColumn.HeaderStyle>
                                <Style TargetType="DataGridColumnHeader">
                                    <Setter Property="Background" Value="{StaticResource HeaderBrush}"/>
                                    <Setter Property="BorderBrush" Value="Black"/>
                                    <Setter Property="BorderThickness" Value="2,2,0,1"/>
                                    <Setter Property="FontWeight" Value="Bold"/>
                                    <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                </Style>
                            </DataGridTextColumn.HeaderStyle>
                            <DataGridTextColumn.CellStyle>
                                <Style TargetType="DataGridCell">
                                    <Setter Property="BorderBrush" Value="Black"/>
                                    <Setter Property="BorderThickness" Value="2,0,0,1"/>
                                    <Style.Triggers>
                                        <Trigger Property="IsSelected" Value="False">
                                            <Setter Property="Background" Value="#FFC5D9F1"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGridTextColumn.CellStyle>
                        </DataGridTextColumn>
                        <DataGridTextColumn Header="Наименование" Binding="{Binding Path=Formula.Name}" Width="200" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.FormulaIsReadOnly}">
                            <DataGridTextColumn.HeaderStyle>
                                <Style TargetType="DataGridColumnHeader">
                                    <Setter Property="Background" Value="{StaticResource HeaderBrush}"/>
                                    <Setter Property="BorderBrush" Value="Black"/>
                                    <Setter Property="BorderThickness" Value="1,2,0,1"/>
                                    <Setter Property="Padding" Value="4,0"/>
                                    <Setter Property="FontWeight" Value="Bold"/>
                                    <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                </Style>
                            </DataGridTextColumn.HeaderStyle>
                            <DataGridTextColumn.CellStyle>
                                <Style TargetType="DataGridCell">
                                    <Setter Property="BorderBrush" Value="Black"/>
                                    <Setter Property="BorderThickness" Value="1,0,0,1"/>
                                    <Style.Triggers>
                                        <Trigger Property="IsSelected" Value="False">
                                            <Setter Property="Background" Value="#FFFFF0E4"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGridTextColumn.CellStyle>
                        </DataGridTextColumn>
                        <DataGridTextColumn Header="Формула 1" Binding="{Binding Path=Formula.Formula1, UpdateSourceTrigger=LostFocus}" ElementStyle="{StaticResource StyleTextBlockAlignmentRight}" EditingElementStyle="{StaticResource StyleTextBoxAlignmentRight}" Width="200" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.FormulaIsReadOnly}">
                            <DataGridTextColumn.HeaderStyle>
                                <Style TargetType="DataGridColumnHeader">
                                    <Setter Property="Background" Value="{StaticResource HeaderBrush}"/>
                                    <Setter Property="BorderBrush" Value="Black"/>
                                    <Setter Property="BorderThickness" Value="1,2,0,1"/>
                                    <Setter Property="Padding" Value="4,0"/>
                                    <Setter Property="FontWeight" Value="Bold"/>
                                    <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                </Style>
                            </DataGridTextColumn.HeaderStyle>
                            <DataGridTextColumn.CellStyle>
                                <Style TargetType="DataGridCell">
                                    <Setter Property="BorderBrush" Value="Black"/>
                                    <Setter Property="BorderThickness" Value="1,0,0,1"/>
                                    <Setter Property="Padding" Value="4,0"/>
                                    <Style.Triggers>
                                        <Trigger Property="IsSelected" Value="False">
                                            <Setter Property="Background" Value="#FFFFF0E4"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGridTextColumn.CellStyle>
                        </DataGridTextColumn>
                        <DataGridTextColumn Header="Формула 2" Binding="{Binding Path=Formula.Formula2, UpdateSourceTrigger=LostFocus}" Width="100" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.FormulaIsReadOnly}">
                            <DataGridTextColumn.HeaderStyle>
                                <Style TargetType="DataGridColumnHeader">
                                    <Setter Property="Background" Value="{StaticResource HeaderBrush}"/>
                                    <Setter Property="BorderBrush" Value="Black"/>
                                    <Setter Property="BorderThickness" Value="1,2,2,1"/>
                                    <Setter Property="Padding" Value="4,0"/>
                                    <Setter Property="FontWeight" Value="Bold"/>
                                    <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                </Style>
                            </DataGridTextColumn.HeaderStyle>
                            <DataGridTextColumn.CellStyle>
                                <Style TargetType="DataGridCell">
                                    <Setter Property="BorderBrush" Value="Black"/>
                                    <Setter Property="BorderThickness" Value="1,0,2,1"/>
                                    <Style.Triggers>
                                        <Trigger Property="IsSelected" Value="False">
                                            <Setter Property="Background" Value="#FFFFF0E4"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGridTextColumn.CellStyle>
                        </DataGridTextColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm1ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}" >
                            <DataGridTemplateColumn.HeaderStyle>
                                <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource AlgorithmHeaderStyle}">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <StackPanel>
                                                    <TextBlock Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[0].Name, Mode=OneWay}" Margin="4,0" MinWidth="100" FontWeight="Bold"/>
                                                    <TextBox Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[0].Name, Mode=TwoWay}" Margin="4,0" Visibility="Collapsed" MinWidth="100" LostFocus="AlgorithmHeader_LostFocus" />
                                                </StackPanel>
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </DataGridTemplateColumn.HeaderStyle>
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[0].Value1, StringFormat=\{0:0.########\}}" TextAlignment="Right" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[0].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[0].Value2, StringFormat=\{0:0.########\}}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid FocusManager.IsFocusScope="False">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[0].Value1, StringFormat=\{0:0.########\}, TargetNullValue='', UpdateSourceTrigger=LostFocus}" IsReadOnly="{Binding Path=IsReadOnly}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[0].Value2, StringFormat=\{0:0.########\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm2ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}">
                            <DataGridTemplateColumn.HeaderStyle>
                                <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource AlgorithmHeaderStyle}">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <StackPanel>
                                                    <TextBlock Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[1].Name, Mode=OneWay}" Margin="4" MinWidth="100" FontWeight="Bold"/>
                                                    <TextBox Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[1].Name, Mode=TwoWay}" Margin="4" Visibility="Collapsed" MinWidth="100" LostFocus="AlgorithmHeader_LostFocus" />
                                                </StackPanel>
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                    <EventSetter Event="PreviewMouseLeftButtonDown" Handler="AlgorithmHeader_MouseLeftButtonUp"/>
                                </Style>
                            </DataGridTemplateColumn.HeaderStyle>
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[1].Value1, StringFormat=\{0:0.########\}}" TextAlignment="Right" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[1].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[1].Value2, StringFormat=\{0:0.########\}}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[1].Value1, StringFormat=\{0:0.########\}, TargetNullValue='', UpdateSourceTrigger=LostFocus}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[1].Value2, StringFormat=\{0:0.########\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm3ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}">
                            <DataGridTemplateColumn.HeaderStyle>
                                <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource AlgorithmHeaderStyle}">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <StackPanel>
                                                    <TextBlock Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[2].Name, Mode=OneWay}" Margin="4,0" MinWidth="100" FontWeight="Bold"/>
                                                    <TextBox Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[2].Name, Mode=TwoWay}" Margin="4,0" Visibility="Collapsed" MinWidth="100" LostFocus="AlgorithmHeader_LostFocus" />
                                                </StackPanel>
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </DataGridTemplateColumn.HeaderStyle>
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[2].Value1, StringFormat=\{0:0.########\}}" TextAlignment="Right" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[2].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[2].Value2, StringFormat=\{0:0.########\}}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[2].Value1, StringFormat=\{0:0.########\}, TargetNullValue='', UpdateSourceTrigger=LostFocus}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[2].Value2, StringFormat=\{0:0.########\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm4ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}" >
                            <DataGridTemplateColumn.HeaderStyle>
                                <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource AlgorithmHeaderStyle}">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <StackPanel>
                                                    <TextBlock Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[3].Name, Mode=OneWay}" Margin="4,0" MinWidth="100" FontWeight="Bold"/>
                                                    <TextBox Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[3].Name, Mode=TwoWay}" Margin="4,0" Visibility="Collapsed" MinWidth="100" LostFocus="AlgorithmHeader_LostFocus" />
                                                </StackPanel>
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </DataGridTemplateColumn.HeaderStyle>
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[3].Value1, StringFormat=\{0:0.########\}}" TextAlignment="Right" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[3].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[3].Value2, StringFormat=\{0:0.########\}}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid FocusManager.IsFocusScope="False">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[3].Value1, StringFormat=\{0:0.########\}, TargetNullValue='', UpdateSourceTrigger=LostFocus}" IsReadOnly="{Binding Path=IsReadOnly}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[3].Value2, StringFormat=\{0:0.########\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm5ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}" >
                            <DataGridTemplateColumn.HeaderStyle>
                                <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource AlgorithmHeaderStyle}">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <StackPanel>
                                                    <TextBlock Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[4].Name, Mode=OneWay}" Margin="4,0" MinWidth="100" FontWeight="Bold"/>
                                                    <TextBox Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[4].Name, Mode=TwoWay}" Margin="4,0" Visibility="Collapsed" MinWidth="100" LostFocus="AlgorithmHeader_LostFocus" />
                                                </StackPanel>
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </DataGridTemplateColumn.HeaderStyle>
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[4].Value1, StringFormat=\{0:0.########\}}" TextAlignment="Right" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[4].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[4].Value2, StringFormat=\{0:0.########\}}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid FocusManager.IsFocusScope="False">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[4].Value1, StringFormat=\{0:0.########\}, TargetNullValue='', UpdateSourceTrigger=LostFocus}" IsReadOnly="{Binding Path=IsReadOnly}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[4].Value2, StringFormat=\{0:0.########\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm6ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}" >
                            <DataGridTemplateColumn.HeaderStyle>
                                <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource AlgorithmHeaderStyle}">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <StackPanel>
                                                    <TextBlock Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[5].Name, Mode=OneWay}" Margin="4,0" MinWidth="100" FontWeight="Bold"/>
                                                    <TextBox Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[5].Name, Mode=TwoWay}" Margin="4,0" Visibility="Collapsed" MinWidth="100" LostFocus="AlgorithmHeader_LostFocus" />
                                                </StackPanel>
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </DataGridTemplateColumn.HeaderStyle>
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[5].Value1, StringFormat=\{0:0.########\}}" TextAlignment="Right" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[5].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[5].Value2, StringFormat=\{0:0.########\}}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid FocusManager.IsFocusScope="False">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[5].Value1, StringFormat=\{0:0.########\}, TargetNullValue='', UpdateSourceTrigger=LostFocus}" IsReadOnly="{Binding Path=IsReadOnly}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[5].Value2, StringFormat=\{0:0.########\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm7ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}" >
                            <DataGridTemplateColumn.HeaderStyle>
                                <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource AlgorithmHeaderStyle}">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <StackPanel>
                                                    <TextBlock Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[6].Name, Mode=OneWay}" Margin="4,0" MinWidth="100" FontWeight="Bold"/>
                                                    <TextBox Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[6].Name, Mode=TwoWay}" Margin="4,0" Visibility="Collapsed" MinWidth="100" LostFocus="AlgorithmHeader_LostFocus" />
                                                </StackPanel>
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </DataGridTemplateColumn.HeaderStyle>
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[6].Value1, StringFormat=\{0:0.########\}}" TextAlignment="Right" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[6].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[6].Value2, StringFormat=\{0:0.########\}}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid FocusManager.IsFocusScope="False">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[6].Value1, StringFormat=\{0:0.########\}, TargetNullValue='', UpdateSourceTrigger=LostFocus}" IsReadOnly="{Binding Path=IsReadOnly}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[6].Value2, StringFormat=\{0:0.########\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm8ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}" >
                            <DataGridTemplateColumn.HeaderStyle>
                                <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource AlgorithmHeaderStyle}">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <StackPanel>
                                                    <TextBlock Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[7].Name, Mode=OneWay}" Margin="4,0" MinWidth="100" FontWeight="Bold"/>
                                                    <TextBox Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[7].Name, Mode=TwoWay}" Margin="4,0" Visibility="Collapsed" MinWidth="100" LostFocus="AlgorithmHeader_LostFocus" />
                                                </StackPanel>
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </DataGridTemplateColumn.HeaderStyle>
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[7].Value1, StringFormat=\{0:0.########\}}" TextAlignment="Right" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[7].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[7].Value2, StringFormat=\{0:0.########\}}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid FocusManager.IsFocusScope="False">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[7].Value1, StringFormat=\{0:0.########\}, TargetNullValue='', UpdateSourceTrigger=LostFocus}" IsReadOnly="{Binding Path=IsReadOnly}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[7].Value2, StringFormat=\{0:0.########\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm9ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}" >
                            <DataGridTemplateColumn.HeaderStyle>
                                <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource AlgorithmHeaderStyle}">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <StackPanel>
                                                    <TextBlock Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[8].Name, Mode=OneWay}" Margin="4,0" MinWidth="100" FontWeight="Bold"/>
                                                    <TextBox Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[8].Name, Mode=TwoWay}" Margin="4,0" Visibility="Collapsed" MinWidth="100" LostFocus="AlgorithmHeader_LostFocus" />
                                                </StackPanel>
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </DataGridTemplateColumn.HeaderStyle>
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[8].Value1, StringFormat=\{0:0.########\}}" TextAlignment="Right" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[8].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[8].Value2, StringFormat=\{0:0.########\}}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid FocusManager.IsFocusScope="False">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[8].Value1, StringFormat=\{0:0.########\}, TargetNullValue='', UpdateSourceTrigger=LostFocus}" IsReadOnly="{Binding Path=IsReadOnly}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[8].Value2, StringFormat=\{0:0.########\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm10ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}" >
                            <DataGridTemplateColumn.HeaderStyle>
                                <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource AlgorithmHeaderStyle}">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <StackPanel>
                                                    <TextBlock Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[9].Name, Mode=OneWay}" Margin="4,0" MinWidth="100" FontWeight="Bold"/>
                                                    <TextBox Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[9].Name, Mode=TwoWay}" Margin="4,0" Visibility="Collapsed" MinWidth="100" LostFocus="AlgorithmHeader_LostFocus" />
                                                </StackPanel>
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </DataGridTemplateColumn.HeaderStyle>
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[9].Value1, StringFormat=\{0:0.########\}}" TextAlignment="Right" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[9].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[9].Value2, StringFormat=\{0:0.########\}}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid FocusManager.IsFocusScope="False">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[9].Value1, StringFormat=\{0:0.########\}, TargetNullValue='', UpdateSourceTrigger=LostFocus}" IsReadOnly="{Binding Path=IsReadOnly}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[9].Value2, StringFormat=\{0:0.########\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm11ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}" >
                            <DataGridTemplateColumn.HeaderStyle>
                                <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource AlgorithmHeaderStyle}">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <StackPanel>
                                                    <TextBlock Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[10].Name, Mode=OneWay}" Margin="4,0" MinWidth="100" FontWeight="Bold"/>
                                                    <TextBox Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[10].Name, Mode=TwoWay}" Margin="4,0" Visibility="Collapsed" MinWidth="100" LostFocus="AlgorithmHeader_LostFocus" />
                                                </StackPanel>
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </DataGridTemplateColumn.HeaderStyle>
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[10].Value1, StringFormat=\{0:0.########\}}" TextAlignment="Right" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[10].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[10].Value2, StringFormat=\{0:0.########\}}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid FocusManager.IsFocusScope="False">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[10].Value1, StringFormat=\{0:0.########\}, TargetNullValue='', UpdateSourceTrigger=LostFocus}" IsReadOnly="{Binding Path=IsReadOnly}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[10].Value2, StringFormat=\{0:0.########\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm12ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}" >
                            <DataGridTemplateColumn.HeaderStyle>
                                <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource AlgorithmHeaderStyle}">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <StackPanel>
                                                    <TextBlock Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[11].Name, Mode=OneWay}" Margin="4,0" MinWidth="100" FontWeight="Bold"/>
                                                    <TextBox Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[11].Name, Mode=TwoWay}" Margin="4,0" Visibility="Collapsed" MinWidth="100" LostFocus="AlgorithmHeader_LostFocus" />
                                                </StackPanel>
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </DataGridTemplateColumn.HeaderStyle>
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[11].Value1, StringFormat=\{0:0.########\}}" TextAlignment="Right" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[11].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[11].Value2, StringFormat=\{0:0.########\}}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid FocusManager.IsFocusScope="False">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[11].Value1, StringFormat=\{0:0.########\}, TargetNullValue='', UpdateSourceTrigger=LostFocus}" IsReadOnly="{Binding Path=IsReadOnly}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[11].Value2, StringFormat=\{0:0.########\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm13ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}" >
                            <DataGridTemplateColumn.HeaderStyle>
                                <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource AlgorithmHeaderStyle}">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <StackPanel>
                                                    <TextBlock Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[12].Name, Mode=OneWay}" Margin="4,0" MinWidth="100" FontWeight="Bold"/>
                                                    <TextBox Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[12].Name, Mode=TwoWay}" Margin="4,0" Visibility="Collapsed" MinWidth="100" LostFocus="AlgorithmHeader_LostFocus" />
                                                </StackPanel>
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </DataGridTemplateColumn.HeaderStyle>
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[12].Value1, StringFormat=\{0:0.########\}}" TextAlignment="Right" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[12].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[12].Value2, StringFormat=\{0:0.########\}}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid FocusManager.IsFocusScope="False">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[12].Value1, StringFormat=\{0:0.########\}, TargetNullValue='', UpdateSourceTrigger=LostFocus}" IsReadOnly="{Binding Path=IsReadOnly}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[12].Value2, StringFormat=\{0:0.########\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm14ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}" >
                            <DataGridTemplateColumn.HeaderStyle>
                                <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource AlgorithmHeaderStyle}">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <StackPanel>
                                                    <TextBlock Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[13].Name, Mode=OneWay}" Margin="4,0" MinWidth="100" FontWeight="Bold"/>
                                                    <TextBox Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[13].Name, Mode=TwoWay}" Margin="4,0" Visibility="Collapsed" MinWidth="100" LostFocus="AlgorithmHeader_LostFocus" />
                                                </StackPanel>
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </DataGridTemplateColumn.HeaderStyle>
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[13].Value1, StringFormat=\{0:0.########\}}" TextAlignment="Right" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[13].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[13].Value2, StringFormat=\{0:0.########\}}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid FocusManager.IsFocusScope="False">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[13].Value1, StringFormat=\{0:0.########\}, TargetNullValue='', UpdateSourceTrigger=LostFocus}" IsReadOnly="{Binding Path=IsReadOnly}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[13].Value2, StringFormat=\{0:0.########\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm15ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}" >
                            <DataGridTemplateColumn.HeaderStyle>
                                <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource AlgorithmHeaderStyle}">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <StackPanel>
                                                    <TextBlock Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[14].Name, Mode=OneWay}" Margin="4,0" MinWidth="100" FontWeight="Bold"/>
                                                    <TextBox Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[14].Name, Mode=TwoWay}" Margin="4,0" Visibility="Collapsed" MinWidth="100" LostFocus="AlgorithmHeader_LostFocus" />
                                                </StackPanel>
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </DataGridTemplateColumn.HeaderStyle>
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[14].Value1, StringFormat=\{0:0.########\}}" TextAlignment="Right" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[14].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[14].Value2, StringFormat=\{0:0.########\}}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid FocusManager.IsFocusScope="False">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[14].Value1, StringFormat=\{0:0.########\}, TargetNullValue='', UpdateSourceTrigger=LostFocus}" IsReadOnly="{Binding Path=IsReadOnly}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[14].Value2, StringFormat=\{0:0.########\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm16ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}" >
                            <DataGridTemplateColumn.HeaderStyle>
                                <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource AlgorithmHeaderStyle}">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <StackPanel>
                                                    <TextBlock Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[15].Name, Mode=OneWay}" Margin="4,0" MinWidth="100" FontWeight="Bold"/>
                                                    <TextBox Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[15].Name, Mode=TwoWay}" Margin="4,0" Visibility="Collapsed" MinWidth="100" LostFocus="AlgorithmHeader_LostFocus" />
                                                </StackPanel>
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </DataGridTemplateColumn.HeaderStyle>
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[15].Value1, StringFormat=\{0:0.########\}}" TextAlignment="Right" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[15].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[15].Value2, StringFormat=\{0:0.########\}}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid FocusManager.IsFocusScope="False">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[15].Value1, StringFormat=\{0:0.########\}, TargetNullValue='', UpdateSourceTrigger=LostFocus}" IsReadOnly="{Binding Path=IsReadOnly}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[15].Value2, StringFormat=\{0:0.########\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm17ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}" >
                            <DataGridTemplateColumn.HeaderStyle>
                                <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource AlgorithmHeaderStyle}">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <StackPanel>
                                                    <TextBlock Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[16].Name, Mode=OneWay}" Margin="4,0" MinWidth="100" FontWeight="Bold"/>
                                                    <TextBox Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[16].Name, Mode=TwoWay}" Margin="4,0" Visibility="Collapsed" MinWidth="100" LostFocus="AlgorithmHeader_LostFocus" />
                                                </StackPanel>
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </DataGridTemplateColumn.HeaderStyle>
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[16].Value1, StringFormat=\{0:0.########\}}" TextAlignment="Right" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[16].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[16].Value2, StringFormat=\{0:0.########\}}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid FocusManager.IsFocusScope="False">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[16].Value1, StringFormat=\{0:0.########\}, TargetNullValue='', UpdateSourceTrigger=LostFocus}" IsReadOnly="{Binding Path=IsReadOnly}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[16].Value2, StringFormat=\{0:0.########\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm18ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}" >
                            <DataGridTemplateColumn.HeaderStyle>
                                <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource AlgorithmHeaderStyle}">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <StackPanel>
                                                    <TextBlock Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[17].Name, Mode=OneWay}" Margin="4,0" MinWidth="100" FontWeight="Bold"/>
                                                    <TextBox Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[17].Name, Mode=TwoWay}" Margin="4,0" Visibility="Collapsed" MinWidth="100" LostFocus="AlgorithmHeader_LostFocus" />
                                                </StackPanel>
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </DataGridTemplateColumn.HeaderStyle>
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[17].Value1, StringFormat=\{0:0.########\}}" TextAlignment="Right" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[17].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[17].Value2, StringFormat=\{0:0.########\}}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid FocusManager.IsFocusScope="False">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[17].Value1, StringFormat=\{0:0.########\}, TargetNullValue='', UpdateSourceTrigger=LostFocus}" IsReadOnly="{Binding Path=IsReadOnly}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[17].Value2, StringFormat=\{0:0.########\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm19ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}" >
                            <DataGridTemplateColumn.HeaderStyle>
                                <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource AlgorithmHeaderStyle}">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <StackPanel>
                                                    <TextBlock Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[18].Name, Mode=OneWay}" Margin="4,0" MinWidth="100" FontWeight="Bold"/>
                                                    <TextBox Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[18].Name, Mode=TwoWay}" Margin="4,0" Visibility="Collapsed" MinWidth="100" LostFocus="AlgorithmHeader_LostFocus" />
                                                </StackPanel>
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </DataGridTemplateColumn.HeaderStyle>
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[18].Value1, StringFormat=\{0:0.########\}}" TextAlignment="Right" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[18].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[18].Value2, StringFormat=\{0:0.########\}}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid FocusManager.IsFocusScope="False">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[18].Value1, StringFormat=\{0:0.########\}, TargetNullValue='', UpdateSourceTrigger=LostFocus}" IsReadOnly="{Binding Path=IsReadOnly}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[18].Value2, StringFormat=\{0:0.########\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm20ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}" >
                            <DataGridTemplateColumn.HeaderStyle>
                                <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource AlgorithmHeaderStyle}">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <StackPanel>
                                                    <TextBlock Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[19].Name, Mode=OneWay}" Margin="4,0" MinWidth="100" FontWeight="Bold"/>
                                                    <TextBox Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[19].Name, Mode=TwoWay}" Margin="4,0" Visibility="Collapsed" MinWidth="100" LostFocus="AlgorithmHeader_LostFocus" />
                                                </StackPanel>
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </DataGridTemplateColumn.HeaderStyle>
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[19].Value1, StringFormat=\{0:0.########\}}" TextAlignment="Right" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[19].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[19].Value2, StringFormat=\{0:0.########\}}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid FocusManager.IsFocusScope="False">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[19].Value1, StringFormat=\{0:0.########\}, TargetNullValue='', UpdateSourceTrigger=LostFocus}" IsReadOnly="{Binding Path=IsReadOnly}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[19].Value2, StringFormat=\{0:0.########\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm21ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}" >
                            <DataGridTemplateColumn.HeaderStyle>
                                <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource AlgorithmHeaderStyle}">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <StackPanel>
                                                    <TextBlock Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[20].Name, Mode=OneWay}" Margin="4,0" MinWidth="100" FontWeight="Bold"/>
                                                    <TextBox Text="{Binding Source={StaticResource MainData}, Path=Data.AlgorithmValues[20].Name, Mode=TwoWay}" Margin="4,0" Visibility="Collapsed" MinWidth="100" LostFocus="AlgorithmHeader_LostFocus" />
                                                </StackPanel>
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </DataGridTemplateColumn.HeaderStyle>
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[20].Value1, StringFormat=\{0:0.########\}}" TextAlignment="Right" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[20].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[20].Value2, StringFormat=\{0:0.########\}}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid FocusManager.IsFocusScope="False">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[20].Value1, StringFormat=\{0:0.########\}, TargetNullValue='', UpdateSourceTrigger=LostFocus}" IsReadOnly="{Binding Path=IsReadOnly}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[20].Value2, StringFormat=\{0:0.########\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>
                <DataGrid Grid.Row="1" x:Name="DataGrid2" ItemsSource="{Binding View2}" HeadersVisibility="Column" SelectedIndex="-1" CanUserAddRows="False" CanUserDeleteRows="False" CanUserReorderColumns="False" CanUserResizeColumns="False" CanUserSortColumns="False" RowDetailsVisibilityMode="Collapsed" AutoGenerateColumns="False" RowHeaderWidth="15" CanUserResizeRows="False" FrozenColumnCount="4" HorizontalAlignment="Left" ClipboardCopyMode="ExcludeHeader"
                          VerticalGridLinesBrush="Transparent" HorizontalGridLinesBrush="Transparent" BorderThickness="0" BorderBrush="{x:Null}" GridLinesVisibility="None" Background="White" HorizontalScrollBarVisibility="Disabled"
                          SizeChanged="DataGrid2_SizeChanged">
                    <DataGrid.CommandBindings>
                        <CommandBinding Command="{x:Static ApplicationCommands.Delete}" 
                            CanExecute="Delete_CanExecute"
                            Executed="Delete_Execute" />
                        <CommandBinding Command="{x:Static ApplicationCommands.Cut}" 
                            CanExecute="DeleteAlgorithm_CanExecute"
                            Executed="DeleteAlgorithm_Execute" />
                    </DataGrid.CommandBindings>
                    <DataGrid.Resources>
                        <Style x:Key="FormulaHeaderStyle" TargetType="DataGridColumnHeader">
                            <Setter Property="Height" Value="7"/>
                            <Setter Property="BorderBrush" Value="Black"/>
                            <Setter Property="BorderThickness" Value="0,0,0,2"/>
                            <Setter Property="Background" Value="Transparent"/>
                        </Style>
                        <Style x:Key="AlgorithmHeaderStyle" TargetType="DataGridColumnHeader" BasedOn="{StaticResource FormulaHeaderStyle}">
                            <Setter Property="Margin" Value="6,0,0,0"/>
                        </Style>
                        <Style x:Key="AlgorithmCellStyle" TargetType="DataGridCell">
                            <Setter Property="BorderBrush" Value="Black"/>
                            <Setter Property="BorderThickness" Value="2,0,2,1"/>
                            <Setter Property="Margin" Value="6,0,0,0"/>
                            <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                        </Style>
                    </DataGrid.Resources>
                    <DataGrid.Columns>
                        <DataGridTextColumn Binding="{Binding Path=Formula.Code, UpdateSourceTrigger=LostFocus}" HeaderStyle="{StaticResource FormulaHeaderStyle}" ElementStyle="{StaticResource StyleTextBlockAlignmentCenterErr}" EditingElementStyle="{StaticResource StyleTextBoxAlignmentCenterErr}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.FormulaIsReadOnly}">
                            <DataGridTextColumn.CellStyle>
                                <Style TargetType="DataGridCell">
                                    <Setter Property="BorderBrush" Value="Black"/>
                                    <Setter Property="BorderThickness" Value="2,0,0,1"/>
                                    <Style.Triggers>
                                        <Trigger Property="IsSelected" Value="False">
                                            <Setter Property="Background" Value="#FFC5D9F1"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGridTextColumn.CellStyle>
                        </DataGridTextColumn>
                        <DataGridTextColumn Binding="{Binding Path=Formula.Name}" HeaderStyle="{StaticResource FormulaHeaderStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.FormulaIsReadOnly}">
                            <DataGridTextColumn.CellStyle>
                                <Style TargetType="DataGridCell">
                                    <Setter Property="BorderBrush" Value="Black"/>
                                    <Setter Property="BorderThickness" Value="1,0,0,1"/>
                                    <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                    <Style.Triggers>
                                        <Trigger Property="IsSelected" Value="False">
                                            <Setter Property="Background" Value="{Binding Path=Formula.NameBackground}"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGridTextColumn.CellStyle>
                        </DataGridTextColumn>
                        <DataGridTextColumn Binding="{Binding Path=Formula.Formula1, UpdateSourceTrigger=LostFocus}" HeaderStyle="{StaticResource FormulaHeaderStyle}" ElementStyle="{StaticResource ErrorStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.FormulaIsReadOnly}">
                            <DataGridTextColumn.CellStyle>
                                <Style TargetType="DataGridCell">
                                    <Setter Property="BorderBrush" Value="Black"/>
                                    <Setter Property="BorderThickness" Value="1,0,0,1"/>
                                    <Setter Property="Padding" Value="4,0"/>
                                    <Setter Property="FontWeight" Value="{Binding Path=Formula.Formula1FontWeight}"/>
                                    <Style.Triggers>
                                        <Trigger Property="IsSelected" Value="False">
                                            <Setter Property="Background" Value="{Binding Path=Formula.Formula1Background}"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGridTextColumn.CellStyle>
                        </DataGridTextColumn>
                        <DataGridTextColumn Binding="{Binding Path=Formula.Formula2, UpdateSourceTrigger=LostFocus}" HeaderStyle="{StaticResource FormulaHeaderStyle}" ElementStyle="{StaticResource ErrorStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.FormulaIsReadOnly}">
                            <DataGridTextColumn.CellStyle>
                                <Style TargetType="DataGridCell">
                                    <Setter Property="BorderBrush" Value="Black"/>
                                    <Setter Property="BorderThickness" Value="1,0,2,1"/>
                                    <Setter Property="FontWeight" Value="{Binding Path=Formula.Formula2FontWeight}"/>
                                    <Style.Triggers>
                                        <Trigger Property="IsSelected" Value="False">
                                            <Setter Property="Background" Value="{Binding Path=Formula.Formula2Background}"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGridTextColumn.CellStyle>
                        </DataGridTextColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm1ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" HeaderStyle="{StaticResource AlgorithmHeaderStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[0].Value1, StringFormat=\{0:N1\}}" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[0].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[0].Value2, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                        <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                                <Setter Property="Background" Value="{Binding Path=AlgorithmValues[0].Value2Background}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[0].Value1, StringFormat=\{0:N1\}, UpdateSourceTrigger=LostFocus, TargetNullValue=''}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[0].Value2, StringFormat=\{0:N1\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm2ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" HeaderStyle="{StaticResource AlgorithmHeaderStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[1].Value1, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[1].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[1].Value2, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                        <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                                <Setter Property="Background" Value="{Binding Path=AlgorithmValues[1].Value2Background}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[1].Value1, StringFormat=\{0:N1\}, UpdateSourceTrigger=LostFocus, TargetNullValue=''}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[1].Value2, StringFormat=\{0:N1\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm3ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" HeaderStyle="{StaticResource AlgorithmHeaderStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[2].Value1, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[2].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[2].Value2, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                        <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                                <Setter Property="Background" Value="{Binding Path=AlgorithmValues[2].Value2Background}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[2].Value1, StringFormat=\{0:N1\}, UpdateSourceTrigger=LostFocus, TargetNullValue=''}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[2].Value2, StringFormat=\{0:N1\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm4ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" HeaderStyle="{StaticResource AlgorithmHeaderStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[3].Value1, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[3].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[3].Value2, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                        <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                                <Setter Property="Background" Value="{Binding Path=AlgorithmValues[3].Value2Background}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[3].Value1, StringFormat=\{0:N1\}, UpdateSourceTrigger=LostFocus, TargetNullValue=''}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[3].Value2, StringFormat=\{0:N1\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm5ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" HeaderStyle="{StaticResource AlgorithmHeaderStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[4].Value1, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[4].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[4].Value2, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                        <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                                <Setter Property="Background" Value="{Binding Path=AlgorithmValues[4].Value2Background}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[4].Value1, StringFormat=\{0:N1\}, UpdateSourceTrigger=LostFocus, TargetNullValue=''}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[4].Value2, StringFormat=\{0:N1\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm6ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" HeaderStyle="{StaticResource AlgorithmHeaderStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[5].Value1, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[5].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[5].Value2, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                        <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                                <Setter Property="Background" Value="{Binding Path=AlgorithmValues[5].Value2Background}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[5].Value1, StringFormat=\{0:N1\}, UpdateSourceTrigger=LostFocus, TargetNullValue=''}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[5].Value2, StringFormat=\{0:N1\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm7ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" HeaderStyle="{StaticResource AlgorithmHeaderStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[6].Value1, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[6].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[6].Value2, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                        <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                                <Setter Property="Background" Value="{Binding Path=AlgorithmValues[6].Value2Background}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[6].Value1, StringFormat=\{0:N1\}, UpdateSourceTrigger=LostFocus, TargetNullValue=''}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[6].Value2, StringFormat=\{0:N1\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm8ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" HeaderStyle="{StaticResource AlgorithmHeaderStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[7].Value1, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[7].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[7].Value2, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                        <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                                <Setter Property="Background" Value="{Binding Path=AlgorithmValues[7].Value2Background}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[7].Value1, StringFormat=\{0:N1\}, UpdateSourceTrigger=LostFocus, TargetNullValue=''}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[7].Value2, StringFormat=\{0:N1\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm9ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" HeaderStyle="{StaticResource AlgorithmHeaderStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[8].Value1, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[8].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[8].Value2, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                        <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                                <Setter Property="Background" Value="{Binding Path=AlgorithmValues[8].Value2Background}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[8].Value1, StringFormat=\{0:N1\}, UpdateSourceTrigger=LostFocus, TargetNullValue=''}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[8].Value2, StringFormat=\{0:N1\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm10ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" HeaderStyle="{StaticResource AlgorithmHeaderStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[9].Value1, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[9].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[9].Value2, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                        <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                                <Setter Property="Background" Value="{Binding Path=AlgorithmValues[9].Value2Background}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[9].Value1, StringFormat=\{0:N1\}, UpdateSourceTrigger=LostFocus, TargetNullValue=''}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[9].Value2, StringFormat=\{0:N1\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm11ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" HeaderStyle="{StaticResource AlgorithmHeaderStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[10].Value1, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[10].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[10].Value2, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                        <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                                <Setter Property="Background" Value="{Binding Path=AlgorithmValues[10].Value2Background}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[10].Value1, StringFormat=\{0:N1\}, UpdateSourceTrigger=LostFocus, TargetNullValue=''}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[10].Value2, StringFormat=\{0:N1\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm12ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" HeaderStyle="{StaticResource AlgorithmHeaderStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[11].Value1, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[11].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[11].Value2, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                        <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                                <Setter Property="Background" Value="{Binding Path=AlgorithmValues[11].Value2Background}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[11].Value1, StringFormat=\{0:N1\}, UpdateSourceTrigger=LostFocus, TargetNullValue=''}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[11].Value2, StringFormat=\{0:N1\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm13ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" HeaderStyle="{StaticResource AlgorithmHeaderStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[12].Value1, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[12].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[12].Value2, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                        <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                                <Setter Property="Background" Value="{Binding Path=AlgorithmValues[12].Value2Background}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[12].Value1, StringFormat=\{0:N1\}, UpdateSourceTrigger=LostFocus, TargetNullValue=''}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[12].Value2, StringFormat=\{0:N1\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm14ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" HeaderStyle="{StaticResource AlgorithmHeaderStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[13].Value1, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[13].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[13].Value2, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                        <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                                <Setter Property="Background" Value="{Binding Path=AlgorithmValues[13].Value2Background}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[13].Value1, StringFormat=\{0:N1\}, UpdateSourceTrigger=LostFocus, TargetNullValue=''}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[13].Value2, StringFormat=\{0:N1\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm15ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" HeaderStyle="{StaticResource AlgorithmHeaderStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[14].Value1, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[14].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[14].Value2, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                        <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                                <Setter Property="Background" Value="{Binding Path=AlgorithmValues[14].Value2Background}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[14].Value1, StringFormat=\{0:N1\}, UpdateSourceTrigger=LostFocus, TargetNullValue=''}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[14].Value2, StringFormat=\{0:N1\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm16ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" HeaderStyle="{StaticResource AlgorithmHeaderStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[15].Value1, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[15].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[15].Value2, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                        <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                                <Setter Property="Background" Value="{Binding Path=AlgorithmValues[15].Value2Background}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[15].Value1, StringFormat=\{0:N1\}, UpdateSourceTrigger=LostFocus, TargetNullValue=''}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[15].Value2, StringFormat=\{0:N1\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm17ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" HeaderStyle="{StaticResource AlgorithmHeaderStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[16].Value1, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[16].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[16].Value2, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                        <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                                <Setter Property="Background" Value="{Binding Path=AlgorithmValues[16].Value2Background}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[16].Value1, StringFormat=\{0:N1\}, UpdateSourceTrigger=LostFocus, TargetNullValue=''}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[16].Value2, StringFormat=\{0:N1\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm18ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" HeaderStyle="{StaticResource AlgorithmHeaderStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[17].Value1, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[17].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[17].Value2, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                        <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                                <Setter Property="Background" Value="{Binding Path=AlgorithmValues[17].Value2Background}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[17].Value1, StringFormat=\{0:N1\}, UpdateSourceTrigger=LostFocus, TargetNullValue=''}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[17].Value2, StringFormat=\{0:N1\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm19ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" HeaderStyle="{StaticResource AlgorithmHeaderStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[18].Value1, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[18].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[18].Value2, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                        <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                                <Setter Property="Background" Value="{Binding Path=AlgorithmValues[18].Value2Background}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[18].Value1, StringFormat=\{0:N1\}, UpdateSourceTrigger=LostFocus, TargetNullValue=''}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[18].Value2, StringFormat=\{0:N1\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm20ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" HeaderStyle="{StaticResource AlgorithmHeaderStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[19].Value1, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[19].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[19].Value2, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                        <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                                <Setter Property="Background" Value="{Binding Path=AlgorithmValues[19].Value2Background}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[19].Value1, StringFormat=\{0:N1\}, UpdateSourceTrigger=LostFocus, TargetNullValue=''}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[19].Value2, StringFormat=\{0:N1\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Visibility="{Binding Source={StaticResource MainData}, Path=Data.Algorithm21ColumnVisibility, Mode=OneWay}" CellStyle="{StaticResource AlgorithmCellStyle}" HeaderStyle="{StaticResource AlgorithmHeaderStyle}" IsReadOnly="{Binding Source={StaticResource MainData},Path=Data.IsReadOnly}">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding AlgorithmValues[20].Value1, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                    <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                            <Setter Property="Background" Value="{Binding Path=AlgorithmValues[20].Value1Background}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0">
                                            <TextBlock Text="{Binding AlgorithmValues[20].Value2, StringFormat=\{0:N1\}}" TextAlignment="Right" Padding="0,0,2,0">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock" BasedOn="{StaticResource StyleTextBlockAlignmentRight}">
                                                        <Setter Property="FontWeight" Value="{Binding Path=Formula.NameFontWeight}"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGridCell}, Path=IsSelected, Mode=OneWay}" Value="False">
                                                                <Setter Property="Background" Value="{Binding Path=AlgorithmValues[20].Value2Background}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding AlgorithmValues[20].Value1, StringFormat=\{0:N1\}, UpdateSourceTrigger=LostFocus, TargetNullValue=''}" TextAlignment="Right" Padding="0,0,2,0"/>
                                        <TextBox Text="{Binding AlgorithmValues[20].Value2, StringFormat=\{0:N1\}, TargetNullValue=''}" Grid.Column="1" BorderBrush="Black" BorderThickness="1,0,0,0" TextAlignment="Right" Padding="0,0,2,0" />
                                    </Grid>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>
            </Grid>
        </ScrollViewer>
    </Grid>
</Window>
